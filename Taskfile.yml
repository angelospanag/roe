version: '3'

tasks:
  dev:
    desc: "ğŸš€ Run the application in dev mode"
    silent: true
    cmds:
      - echo "ğŸš€ Running in dev mode..."
      - go run ./cmd/api

  dev-ui:
    desc: "ğŸš€ Run the UI in dev mode"
    silent: true
    cmds:
      - echo "ğŸš€ Run the UI in dev mode"
      - cd frontend && pnpm dev

  test:
    desc: "ğŸ§ª Run tests"
    silent: true
    cmds:
      - echo "ğŸ§ª Running tests..."
      - go test -v ./...

  fmt:
    desc: "ğŸ¨ Format the code"
    silent: true
    cmds:
      - echo "ğŸ¨ Formatting code..."
      - golangci-lint fmt

  lint:
    desc: "ğŸ” Lint the codebase"
    silent: true
    cmds:
      - echo "ğŸ” Linting code..."
      - golangci-lint run ./... || echo "âš ï¸ Linting issues found"

  update-deps:
    desc: "â¬†ï¸ Update and tidy dependencies"
    silent: true
    cmds:
      - echo "â¬†ï¸ Updating dependencies..."
      - go get -u ./...
      - go mod tidy

  build:
    desc: "ğŸ”§ Build the Go binary"
    silent: true
    cmds:
      - echo "ğŸ”§ Building..."
      - go build -o ./bin/api ./cmd/api

  run:
    desc: "ğŸš€ Build and run the application"
    silent: true
    deps: [ build ]
    cmds:
      - echo "ğŸš€ Running..."
      - ./bin/api

  clean:
    desc: "ğŸ§¹ Clean build artifacts"
    silent: true
    cmds:
      - echo "ğŸ§¹ Cleaning..."
      - rm -rf ./bin

  update-all-deps:
    desc: "Update all dependencies"
    silent: true
    cmds:
      - go get -u ./... && go mod tidy && cd frontend && pnpm update

  generate-client:
    desc: "Generate client"
    silent: true
    cmds:
      - cd frontend && pnpm generate-client
